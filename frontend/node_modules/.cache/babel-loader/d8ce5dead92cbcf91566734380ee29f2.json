{"ast":null,"code":"import _regeneratorRuntime from\"/home/user/Desktop/myProjects/lisa-supermarket-website/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/user/Desktop/myProjects/lisa-supermarket-website/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/user/Desktop/myProjects/lisa-supermarket-website/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useState}from\"react\";import\"./loginPage.scss\";import{MyContext}from\"../../App\";import{useNavigate}from\"react-router-dom\";import{NavLink}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginPage=function LoginPage(){var navigate=useNavigate();var _useContext=useContext(MyContext),setUser=_useContext.setUser,token=_useContext.token,setIsLoggedIn=_useContext.setIsLoggedIn;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var updateData=function updateData(event){switch(event.target.name){case\"email\":setEmail(event.target.value);break;case\"password\":setPassword(event.target.value);break;default:break;}};var attemptLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var loginData,settings,response,parsedRes,now,tokenExpiry;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();loginData={email:email,password:password};settings={method:\"POST\",body:JSON.stringify(loginData),headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+token}/*  credentials: 'include',  */};_context.next=5;return fetch(process.env.REACT_APP_SERVER_URL+\"/login\",settings);case 5:response=_context.sent;_context.next=8;return response.json();case 8:parsedRes=_context.sent;_context.prev=9;if(!response.ok){_context.next=18;break;}now=new Date();tokenExpiry=new Date(now.getTime()+1000*60*60);// localStorage.setItem(\"data\", JSON.stringify({token: parsedRes.token, id: parsedRes.id, expiry: tokenExpiry.toISOString()}));\nsetIsLoggedIn(true);setUser({id:parsedRes.data._id,info:parsedRes.data,expiry:tokenExpiry.toISOString(),token:parsedRes.token});/* setUser({token: parsedRes.token, id: parsedRes.id, firstName: parsedRes.firstName, expiry: tokenExpiry.toISOString()}) */navigate(\"/meals\");_context.next=19;break;case 18:throw new Error(parsedRes.message);case 19:_context.next=26;break;case 21:_context.prev=21;_context.t0=_context[\"catch\"](9);alert(_context.t0.message);setEmail(\"\");setPassword(\"\");case 26:case\"end\":return _context.stop();}}},_callee,null,[[9,21]]);}));return function attemptLogin(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"loginPage\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"formWrapper\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Login-In to your account\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:attemptLogin,className:\"loginForm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"loginFormInput\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"emailFormSection\",children:/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",onChange:updateData,value:email,placeholder:\"Email\",className:\"loginFormEmailPassword\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"passwordlFormSection\",children:/*#__PURE__*/_jsx(\"input\",{typeof:\"password\",name:\"password\",onChange:updateData,value:password,placeholder:\"Password\",className:\"loginFormEmailPassword\"})})]}),/*#__PURE__*/_jsx(\"button\",{children:\"Log In\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"loginParagraph\",children:[\"Every Weekend we update our menu! Don't forget to visit our \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(NavLink,{to:\"/meals\",children:\" Meals Page\"})}),\" to discover new dishes from all around the world.\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\" If you are not registered? Click here \",/*#__PURE__*/_jsx(NavLink,{className:\"registerLink\",to:\"/register\",children:\" Register \"})]})]})});};export default LoginPage;","map":{"version":3,"names":["React","useContext","useState","MyContext","useNavigate","NavLink","LoginPage","navigate","setUser","token","setIsLoggedIn","email","setEmail","password","setPassword","updateData","event","target","name","value","attemptLogin","preventDefault","loginData","settings","method","body","JSON","stringify","headers","fetch","process","env","REACT_APP_SERVER_URL","response","json","parsedRes","ok","now","Date","tokenExpiry","getTime","id","data","_id","info","expiry","toISOString","Error","message","alert"],"sources":["/home/user/Desktop/myProjects/lisa-supermarket-website/frontend/src/views/loginpage/LoginPage.jsx"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport \"./loginPage.scss\";\nimport { MyContext } from \"../../App\";\nimport { useNavigate } from \"react-router-dom\";\nimport { NavLink } from \"react-router-dom\";\n\nconst LoginPage = () => {\n  let navigate = useNavigate();\n  const { setUser, token, setIsLoggedIn } = useContext(MyContext);\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  \n\n  const updateData = (event) => {\n    switch (event.target.name) {\n      case \"email\":\n        setEmail(event.target.value);\n        break;\n      case \"password\":\n        setPassword(event.target.value);\n        break;\n      default:\n        break;\n    }\n  };\n\n  const attemptLogin = async (event) => {\n    event.preventDefault();\n\n    const loginData = {\n      email: email,\n      password: password,\n    };\n\n    const settings = {\n      method: \"POST\",\n      body: JSON.stringify(loginData),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": \"Bearer \" + token\n      },\n    /*  credentials: 'include',  */\n    };\n\n    const response = await fetch(\n      process.env.REACT_APP_SERVER_URL + \"/login\",\n      settings\n    );\n    const parsedRes = await response.json();\n\n    try {\n      if (response.ok) {\n        const now = new Date();\n        const tokenExpiry = new Date(now.getTime() + 1000 * 60 * 60); \n        // localStorage.setItem(\"data\", JSON.stringify({token: parsedRes.token, id: parsedRes.id, expiry: tokenExpiry.toISOString()}));\n        \n        setIsLoggedIn(true);\n        setUser({id:parsedRes.data._id, info:parsedRes.data, expiry: tokenExpiry.toISOString(), token:parsedRes.token })\n\n        /* setUser({token: parsedRes.token, id: parsedRes.id, firstName: parsedRes.firstName, expiry: tokenExpiry.toISOString()}) */\n        navigate(\"/meals\");\n      } else {\n        throw new Error(parsedRes.message);\n      }\n    } catch (err) {\n      alert(err.message);\n      setEmail(\"\");\n      setPassword(\"\");\n    }\n  };\n\n  return (\n    <div className=\"loginPage\">\n      <div className=\"formWrapper\">\n        <h1>Login-In to your account</h1>\n\n        <form onSubmit={attemptLogin} className={\"loginForm\"}>\n          <div className=\"loginFormInput\">\n            <div className=\"emailFormSection\">\n              <input\n                type=\"email\"\n                name=\"email\"\n                onChange={updateData}\n                value={email}\n                placeholder={\"Email\"}\n                className=\"loginFormEmailPassword\"\n              />\n            </div>\n            <div className=\"passwordlFormSection\">\n              <input\n                typeof=\"password\"\n                name=\"password\"\n                onChange={updateData}\n                value={password}\n                placeholder={\"Password\"}\n                className=\"loginFormEmailPassword\"\n              />\n            </div>\n          </div>\n          <button>Log In</button>\n        </form>\n\n        <p className=\"loginParagraph\">\n        Every Weekend we update our menu! Don't forget to visit our <br></br>\n        <span><NavLink to=\"/meals\"> Meals Page</NavLink></span> to discover new dishes from all around the world.\n      </p>\n\n      <div> If you are not registered? Click here <NavLink className=\"registerLink\" to=\"/register\"> Register </NavLink></div>\n\n      </div>\n\n     \n    </div>\n  );\n};\n\nexport default LoginPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}